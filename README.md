# Naive-Bayes-model-applied-to-WTI-Crude-Oil-futures
The code provided trains a Naive Bayes model using scikit-learn and applies it to predict the NYMEX WTI crude oil prices for Q3 2023. Here's a breakdown of the code:

The necessary libraries are imported, including pandas, numpy, matplotlib, MinMaxScaler from scikit-learn, GaussianNB from scikit-learn's Naive Bayes module, and evaluation metrics and TimeSeriesSplit from scikit-learn's metrics and model_selection modules, respectively.

The historical data for NYMEX WTI crude oil prices is loaded from the Quandl API using the provided URL.

The closing prices are extracted from the data and stored in the closing_prices variable.

The closing prices are normalized between 0 and 1 using the MinMaxScaler from scikit-learn.

A helper function create_dataset is defined to create the training and testing datasets. It takes the normalized data and a window size as input and returns arrays of input features (X) and corresponding target values (y).

The window size for the time series data is set to 30.

A TimeSeriesSplit object tscv is created with n_splits=5, which defines the number of splits for walk-forward cross-validation.

Empty lists are initialized to store the evaluation metrics for each cross-validation fold.

The code enters a loop that iterates over the train and test indices generated by tscv.split(normalized_prices).

Inside the loop, the training and testing datasets are created using the create_dataset function and the respective indices.

A Gaussian Naive Bayes model is created.

The model is trained on the training data using the fit method.

Predictions are made on the testing data using the predict method.

The predicted and actual closing prices are denormalized using the inverse transform of the MinMaxScaler.

Various evaluation metrics such as RMSE, MAE, R2 score, MSLE, MPE, MAPE, and explained variance score are calculated using the predicted and actual values.

The evaluation metrics are appended to the respective lists.

The performance of the model is visualized using a line plot, showing the actual and predicted closing prices.

The average scores across all cross-validation folds are calculated using numpy's mean function.

The average scores are printed to the console.

The code performs walk-forward cross-validation with purging and embargo, trains a Naive Bayes model, evaluates its performance using various metrics, and visualizes the predicted and actual closing prices for each fold.
